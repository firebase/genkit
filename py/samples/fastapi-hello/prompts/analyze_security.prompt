---
model: googleai/gemini-2.0-flash
output:
  format: json
  schema:
    type: object
    properties:
      issues:
        type: array
        items:
          type: object
          properties:
            line:
              type: integer
              description: Line number where the issue occurs
            title:
              type: string
              description: Brief title like "SQL Injection Risk"
            severity:
              type: string
              enum: [critical, warning, info]
            category:
              type: string
              enum: [security, bug, style]
            explanation:
              type: string
              description: Why this is a problem
            suggestion:
              type: string
              description: How to fix it
          required: [line, title, severity, category, explanation, suggestion]
    required: [issues]
---
Analyze this {{language}} code for SECURITY vulnerabilities ONLY.

```{{language}}
{{code}}
```

Look for:
- SQL injection
- XSS vulnerabilities
- Command injection
- Hardcoded secrets/credentials
- Path traversal
- Insecure deserialization

IMPORTANT:
- Only report SECURITY issues. Do not report bugs, style, or documentation issues.
- Include the exact line number where the issue occurs.
- All issues must have category: "security"
- If the code is secure, return an empty issues list.
